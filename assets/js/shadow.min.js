var breakpoint=906;function invalid(a,b){if(b===true){a.css("background","").css("color","")}else{a.css("background","#E51C39").css("color","white")}return(b==true)}function updateValue(c){var e=c.html(),f=(c.parent("td").data("label")!==undefined?c.parent("td").data("label"):(c.parent("td").data("value")!==undefined?c.parent("td").data("value"):(c.data("label")!==undefined?c.data("label"):(c.data("value")!==undefined?c.data("value"):c.text())))),a=c.parents(".selected").find(".address"),d=c.parents(".selected").find(".addresstype");a=a.data("value")?a.data("value"):a.text();if(d.length===1){d=d.data("value")?d.data("value"):d.text()}if(d==="Group"){f.replace("group_","")}c.html('<input class="newval" type="text" onchange="bridge.updateAddressLabel(\''+a+'\', this.value);" value="'+f+'" size=60 />');function b(h){var g=$(".newval");if(g.length===0){return}c.html(e.replace(f,g.val().trim()))}$(".newval").focus().on("contextmenu",function(g){g.stopPropagation()}).keyup(function(g){if(g.keyCode==13){b(g)}});$(document).one("click",b)}function updateValueChat(c,b){var d=c.data("value");var a=contacts[b];if(a==undefined){return false}c.html('<input class="new_chat_value" type="text" onchange="bridge.updateAddressLabel(\''+a.address+'\', this.value);" value="'+d+'" size=35 style="display:inline;" />');$("#chat-header .new_chat_value").focus();$("#chat-header .new_chat_value").on("contextmenu",function(f){f.stopPropagation()});$("#chat-header .new_chat_value").keypress(function(f){if(f.which==13){f.preventDefault();var e=$("#chat-header .new_chat_value");if(e==undefined||e.val()===undefined){return false}var g=e.val().trim();if(g==undefined){return false}if(g.length===0){return false}c.html(g);contacts[current_key].label=g;$("#chat-header").data("value",g);$("#contact-"+current_key+" .contact-info .contact-name").text(g);$("#contact-book-"+current_key+" .contact-info .contact-name").text(g)}});$("#chat-header .new_chat_value").click(function(e){e.stopPropagation()});$(document).one("click",function(){var e=$("#chat-header .new_chat_value");if(typeof e===undefined||e.val()===undefined){return false}var f=e.val().trim();if(f==undefined){return false}c.html(f);contacts[current_key].label=f;$("#chat-header").data("value",f);$("#contact-"+current_key+" .contact-info .contact-name").text(f);$("#contact-book-"+current_key+" .contact-info .contact-name").text(f)})}$(function(){$(".footable,.footable-lookup").footable({breakpoints:{phone:480,tablet:700},delay:50}).on({footable_breakpoint:function(){},footable_row_expanded:function(b){var a=$(this).find(".editable");a.off("dblclick").on("dblclick",function(c){c.stopPropagation();updateValue($(this))}).attr("data-title","Double click to edit").tooltip()}});$(".editable").on("dblclick",function(a){a.stopPropagation();updateValue($(this))}).attr("data-title","Double click to edit %column%");window.onresize=function(a){if(window.innerWidth>breakpoint){$("#layout").removeClass("active")}};if(bridge){$("[href='#about']").on("click",function(){bridge.userAction(["aboutClicked"])})}overviewPage.init();receivePageInit();transactionPageInit();addressBookInit();shadowChatInit();chainDataPage.init();walletManagementPage.init();$(".footable > tbody tr").selection()});$.fn.selection=function(a){if(!a){a="tr"}return this.on("click",function(){$(this).addClass("selected").siblings(a).removeClass("selected")})};function connectSignals(){bridge.emitPaste.connect(this,pasteValue);bridge.emitTransactions.connect(this,appendTransactions);bridge.emitAddresses.connect(this,appendAddresses);bridge.emitMessages.connect(this,appendMessages);bridge.emitMessage.connect(this,appendMessage);bridge.emitCoinControlUpdate.connect(sendPage,"updateCoinControlInfo");bridge.triggerElement.connect(this,triggerElement);bridge.emitReceipient.connect(sendPage,"addRecipientDetail");bridge.networkAlert.connect(this,networkAlert);optionsModel.displayUnitChanged.connect(unit,"setType");optionsModel.reserveBalanceChanged.connect(overviewPage,"updateReserved");optionsModel.rowsPerPageChanged.connect(this,"updateRowsPerPage");optionsModel.visibleTransactionsChanged.connect(this,"visibleTransactions");walletModel.encryptionStatusChanged.connect(overviewPage,"encryptionStatusChanged");walletModel.balanceChanged.connect(overviewPage,"updateBalance");overviewPage.clientInfo();optionsPage.update();chainDataPage.updateAnonOutputs()}function triggerElement(b,a){$(b).trigger(a)}function updateRowsPerPage(a){$(".footable").each(function(){var b=$(this);if(b.hasClass("footable-lookup")){return}b.data().pageSize=a;b.trigger("footable_initialize")})}var base58={base58Chars:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",check:function(e){var c=$(e);var d=c.val();for(var b=0,a=d.length;b<a;++b){if(base58.base58Chars.indexOf(d[b])==-1){c.css("background","#E51C39").css("color","white");return false}}c.css("background","").css("color","");return true}};var pasteTo="";function pasteValue(a){$(pasteTo).val(a)}function paste(a){pasteTo=a;bridge.paste();if(pasteTo.indexOf("#pay_to")==0||pasteTo=="#change_address"){base58.check(pasteTo)}}function copy(d,a){var b="";try{b=$(d).text()}catch(c){}if(b==undefined||a!=undefined){if(a=="copy"){b=d}else{b=$(d).attr(a)}}bridge.copy(b)}function networkAlert(a){$("#network-alert span").text(a).toggle(a!=="")}var unit={type:0,name:"SDC",display:"SDC",setType:function(a){this.type=(a==undefined?0:a);switch(a){case 1:this.name="mSDC",this.display="mSDC";break;case 2:this.name="uSDC",this.display="&micro;SDC";break;case 3:this.name="sSDC",this.display="Shadowshi";break;default:this.name=this.display="SDC"}$("td.unit,span.unit,div.unit").html(this.display);$("select.unit").val(a).trigger("change");$("input.unit").val(this.name);overviewPage.updateBalance()},format:function(c,b){var a=($.isNumeric(c)?null:$(c));b=(b==undefined?this.type:parseInt(b)),c=parseInt(a==undefined?c:(a.data("value")==undefined?a.val():a.data("value")));switch(b){case 1:c=c/100000;break;case 2:c=c/100;break;case 3:break;default:c=c/100000000}c=c.toFixed(this.mask(b));if(a==undefined){return c}a.val(c)},parse:function(d,b){var a=($.isNumeric(d)?null:$(d));b=(b==undefined?this.type:parseInt(b)),fp=(a==undefined?d:a.val());if(fp==undefined||fp.length<1){fp=["0","0"]}else{if(fp[0]=="."){fp=["0",fp.slice(1)]}else{fp=fp.split(".")}}d=parseInt(fp[0]);var f=this.mask(b);if(f>0){d*=Math.pow(10,f)}if(f>0&&fp.length>1){var e=fp[1].split("");while(e.length>1&&e[e.length-1]=="0"){e.pop()}var c=parseInt(e.join(""));if(c>0){f-=e.length;if(f>0){c=c*Math.pow(10,f)}d+=c}}if(a==undefined){return d}a.data("value",d);this.format(a,b)},mask:function(a){a=(a==undefined?this.type:parseInt(a));switch(a){case 1:return 5;case 2:return 2;case 3:return 0;default:return 8}},keydown:function(f){var c=f.which,d=$(f.target).siblings(".unit").val();if(c==190||c==110){if(this.value.toString().indexOf(".")!==-1||unit.mask(d)==0){f.preventDefault()}return true}if(!f.shiftKey&&(c>=96&&c<=105||c>=48&&c<=57)){var b=this.selectionStart;var a=this.value.indexOf(".");if(!(document.getSelection().type==="Range")&&b>a&&this.value.indexOf(".")!==-1&&this.value.length-1-a>=unit.mask(d)){if(this.value[this.value.length-1]=="0"&&b<this.value.length){this.value=this.value.slice(0,-1);this.selectionStart=b;this.selectionEnd=b;return}f.preventDefault()}return}if(c==8||c==9||c==17||c==46||c==45||c>=35&&c<=40||(f.ctrlKey&&(c==65||c==67||c==86||c==88))){return}f.preventDefault()},paste:function(b){var a=b.originalEvent.clipboardData.getData("text/plain");if(!($.isNumeric(a))||(this.value.indexOf(".")!==-1&&document.getSelection().type!=="Range")){b.preventDefault()}}};var contextMenus=[];function openContextMenu(b){if(contextMenus.indexOf(b)===-1){contextMenus.push(b)}if(b.isOpen!==undefined&&b.isOpen===1){b.isOpen=0;if(b.close){b.close()}}for(var a=0;a<contextMenus.length;++a){contextMenus[a].isOpen=contextMenus[a]==b?1:0}}var overviewPage={init:function(){this.balance=$(".balance"),this.shadowBal=$(".shadow_balance"),this.reserved=$("#reserved"),this.stake=$("#stake"),this.unconfirmed=$("#unconfirmed"),this.immature=$("#immature"),this.total=$("#total")},updateBalance:function(d,b,a,c,e){if(d==undefined){d=this.balance.data("orig"),b=this.shadowBal.data("orig"),a=this.stake.data("orig"),c=this.unconfirmed.data("orig"),e=this.immature.data("orig")}else{this.balance.data("orig",d),this.shadowBal.data("orig",b),this.stake.data("orig",a),this.unconfirmed.data("orig",c),this.immature.data("orig",e)}this.formatValue("balance",d);this.formatValue("shadowBal",b);this.formatValue("stake",a);this.formatValue("unconfirmed",c);this.formatValue("immature",e);this.formatValue("total",d+a+c+e+b)},updateReserved:function(a){this.formatValue("reserved",a)},formatValue:function(b,a){if(b==="total"&&a!==undefined&&!isNaN(a)){var c=unit.format(a).split(".");$("#total-big > span:first-child").text(c[0]);$("#total-big .cents").text(c[1])}if(b==="stake"&&a!==undefined&&!isNaN(a)){if(a==0){$("#staking-big").addClass("not-staking")}else{$("#staking-big").removeClass("not-staking")}var c=unit.format(a).split(".");$("#staking-big > span:first-child").text(c[0]);$("#staking-big .cents").text(c[1])}b=this[b];if(a==0){b.html("");b.parent("tr").hide()}else{b.text(unit.format(a));b.parent("tr").show()}},recent:function(a){for(var b=0;b<a.length;b++){overviewPage.updateTransaction(a[b])}$("#recenttxns [data-title]").tooltip()},updateTransaction:function(f){var g=function(i){return"<tr><td class='text-left' style='border-top: 1px solid rgba(230, 230, 230, 0.7);border-bottom: none;'><center><label style='margin-top:6px;' class='label label-important inline fs-12'>"+(i.t=="input"?"Received":(i.t=="output"?"Sent":(i.t=="inout"?"In-Out":"Stake")))+"</label></center></td><td class='text-left' style='border-top: 1px solid rgba(230, 230, 230, 0.7);border-bottom: none;'><center><a id='"+i.id.substring(0,17)+"' data-title='"+i.tt+"' href='#' onclick='$(\"#navitems [href=#transactions]\").click();$(\"#"+i.id+"\").click();'> "+unit.format(i.am)+" "+unit.display+" </a></center></td><td style='border-top: 1px solid rgba(230, 230, 230, 0.7);border-bottom: none;'><span class='overview_date' data-value='"+i.d+"'><center>"+i.d_s+"</center></span></td></tr>"};var a=f.id.substring(0,17);if($("#"+a).attr("data-title",f.tt).length==0){var h=$("#recenttxns tr");var b=g(f);var d=false;for(var c=0;c<h.length;c++){var e=$(h[c]);if(parseInt(f.d)>parseInt(e.find(".overview_date").data("value"))){e.before(b);d=true;break}}if(!d){$("#recenttxns").append(b)}h=$("#recenttxns tr");while(h.length>8){$("#recenttxns tr:last").remove();h=$("#recenttxns tr")}}},clientInfo:function(){$("#version").text(bridge.info.build.replace(/\-[\w\d]*$/,""));$("#clientinfo").attr("data-title","Build Desc: "+bridge.info.build+"\nBuild Date: "+bridge.info.date).tooltip()},encryptionStatusChanged:function(a){switch(a){case 0:case 1:case 2:}}};var optionsPage={init:function(){},update:function(){var c=bridge.info.options;$("#options-ok,#options-apply").addClass("disabled");for(var f in c){var e=$("#opt"+f),g=c[f],a=c["opt"+f];if(e.length==0){if(f.indexOf("opt")==-1){console.log("Option element not available for %s",f)}continue}if(a){e.html("");for(var h in a){if(typeof h==="string"&&$.isArray(a[h])&&!$.isNumeric(h)){e.append("<optgroup label='"+h[0].toUpperCase()+h.slice(1)+"'>");for(var d=0;d<a[h].length;d++){e.append("<option>"+a[h][d]+"</option>")}}else{e.append("<option"+($.isNumeric(h)?"":" value='"+h+"'")+">"+a[h]+"</option>")}}}function b(m){m=$(this);var k=m.prop("checked"),n=m.data("linked");if(n){n=n.split(" ")}else{return}for(var l=0;l<n.length;l++){var j=$("#"+n[l]+",[for="+n[l]+"]").attr("disabled",!k);if(k){j.removeClass("disabled")}else{j.addClass("disabled")}}}if(e.is(":checkbox")){e.prop("checked",g===true||g==="true");e.off("change");e.on("change",b);e.change()}else{if(e.is("select[multiple]")&&g==="*"){e.find("option").attr("selected",true)}else{e.val(g)}}e.one("change",function(){$("#options-ok,#options-apply").removeClass("disabled")})}},save:function(){var b=bridge.info.options,f={};for(var d in b){var c=$("#opt"+d),e=b[d],a=false;if(e==null||e=="false"){e=false}if(c.length==0){continue}if(c.is(":checkbox")){a=c.prop("checked")}else{if(c.is("select[multiple]")){a=c.val();if(a===null){a="*"}}else{a=c.val()}}if(e!=a&&e.toString()!==a.toString()){f[d]=a}}if(!$.isEmptyObject(f)){bridge.userAction({optionsChanged:f});optionsPage.update();if(f.hasOwnProperty("AutoRingSize")){changeTxnType()}}}};function receivePageInit(){var a=[{name:"Copy&nbsp;Address",fun:function(){copy("#receive .footable .selected .address")}},{name:"Copy&nbsp;Label",fun:function(){copy("#receive .footable .selected .label2")}},{name:"Copy&nbsp;Public&nbsp;Key",fun:function(){copy("#receive .footable .selected .pubkey")}},{name:"Edit",fun:function(){$("#receive .footable .selected .label2.editable").dblclick()}}];$("#receive .footable tbody").on("contextmenu",function(b){$(b.target).closest("tr").click()}).contextMenu(a,{triggerOn:"contextmenu",sizeStyle:"content"});$("#filter-address").on("input",function(){var b=$("#receive-table");if($("#filter-address").val()===""){b.data("footable-filter").clearFilter()}$("#receive-filter").val($("#filter-address").val()+" "+$("#filter-addresstype").val());b.trigger("footable_filter",{filter:$("#receive-filter").val()})});$("#filter-addresstype").change(function(){var b=$("#receive-table");if($("#filter-addresstype").val()===""){b.data("footable-filter").clearFilter()}$("#receive-filter").val($("#filter-address").val()+" "+$("#filter-addresstype").val());b.trigger("footable_filter",{filter:$("#receive-filter").val()})})}function clearRecvAddress(){$("#new-address-label").val("");$("#new-addresstype").val(1)}function addAddress(){var b=$("#new-addresstype").val();var a=(b=="4")?"group_"+$("#new-address-label").val():$("#new-address-label").val();newAdd=bridge.newAddress(a,b);$("#add-address-modal").modal("hide")}function clearSendAddress(){$("#new-send-label").val("");$("#new-send-address").val("");$("#new-send-address-error").text("");$("#new-send-address").removeClass("inputError")}function addSendAddress(){var d,f,b,a;d=$("#new-send-label").val();f=$("#new-send-address").val();b=bridge.getAddressLabel(f);if(b!==""){$("#new-send-address-error").text('Error: address already in addressbook under "'+b+'"');$("#new-send-address").addClass("inputError");return}var e=0;a=bridge.newAddress(d,e,f,true);if(a===""){var c=bridge.lastAddressError();$("#new-send-address-error").text("Error: "+c);$("#new-send-address").addClass("inputError")}else{updateContact(d,current_key,f,false);$("#add-address-modal").modal("hide")}}function addressBookInit(){var a=[{name:"Copy&nbsp;Address",fun:function(){copy("#addressbook .footable .selected .address")}},{name:"Copy&nbsp;Public&nbsp;Key",fun:function(){copy("#addressbook .footable .selected .pubkey")}},{name:"Copy&nbsp;Label",fun:function(){copy("#addressbook .footable .selected .label2")}},{name:"Edit",fun:function(){$("#addressbook .footable .selected .label2.editable").dblclick()}},{name:"Delete",fun:function(){var b=$("#addressbook .footable .selected .address");if(bridge.deleteAddress(b.text())){b.closest("tr").remove()}}}];$("#addressbook .footable tbody").on("contextmenu",function(b){$(b.target).closest("tr").click()}).contextMenu(a,{triggerOn:"contextmenu",sizeStyle:"content"});$("#filter-addressbook").on("input",function(){var b=$("#addressbook-table");if($("#filter-addressbook").val()==""){b.data("footable-filter").clearFilter()}$("#addressbook-filter").val($("#filter-addressbook").val()+" "+$("#filter-addressbooktype").val());b.trigger("footable_filter",{filter:$("#addressbook-filter").val()})});$("#filter-addressbooktype").change(function(){var b=$("#addressbook-table");if($("#filter-addresstype").val()==""){b.data("footable-filter").clearFilter()}$("#addressbook-filter").val($("#filter-addressbook").val()+" "+$("#filter-addressbooktype").val());b.trigger("footable_filter",{filter:$("#addressbook-filter").val()})})}var Name="You";var initialAddress=true;function appendAddresses(b){if(typeof b=="string"){if(b=="[]"){return}b=JSON.parse(b.replace(/,\]$/,"]"))}contact_book_list=$("#contact-book-list ul");b.forEach(function(d){var i=$("#"+d.address);var e=(d.type=="S"?"#addressbook":(d.label.lastIndexOf("group_",0)!==0?"#receive":"#addressbook"));var c=$("#invite-modal-"+d.address);if(d.type=="R"&&sendPage.initSendBalance(d)&&d.address.length<75&&d.label.lastIndexOf("group_",0)!==0){if(i.length==0){$("#message-from-address").append("<option title='"+d.address+"' value='"+d.address+"'>"+d.label+"</option>")}else{$("#message-from-address option[value="+d.address+"]").text(d.label)}if(initialAddress){$("#message-from-address").prepend("<option title='Anonymous' value='anon' selected>Anonymous</option>");$(".user-name").text(Name);$(".user-address").text(d.address);initialAddress=false}}var h=(d.at==4||d.label.lastIndexOf("group_",0)===0);var f=(d.type=="S");if(h){d.at=4;d.label=d.label.replace("group_","");d.label_value=d.label_value.replace("group_","");f=true}var g=(d.pubkey!=="n/a"?true:false);if(f&&g){createContact(d.label,d.address,h);appendContact(d.address,false,true)}if(!h&&f&&g){if(c.length==0){$("#invite-modal-tbody").append("<tr id='#invite-modal-"+d.address+"' lbl='"+d.label+"'>                   <td style='padding-left:18px;' class='label2' data-value='"+d.label_value+"'>"+d.label+"</td>                   <td class='address'>"+d.address+"</td>                   <td class='invite footable-visible footable-last-column'><input type='checkbox' class='checkbox'></input></td>                   </tr>")}else{$("#invite-modal-"+d.address+" .label2").text(d.label)}}if(i.length==0){$(e+" .footable tbody").append("<tr id='"+d.address+"' lbl='"+d.label+"'>                 <td style='padding-left:18px;' class='label2 editable' data-value='"+d.label_value+"'>"+d.label+"</td>                 <td class='address'>"+d.address+"</td>                 <td class='pubkey'>"+d.pubkey+"</td>                 <td class='addresstype'>"+(d.at==4?"Group":d.at==3?"BIP32":d.at==2?"Stealth":"Normal")+"</td></tr>");$("#"+d.address).selection("tr").find(".editable").on("dblclick",function(j){j.stopPropagation();updateValue($(this))}).attr("data-title","Double click to edit").tooltip()}else{$("#"+d.address+" .label2").data("value",d.label_value).text(d.label);$("#"+d.address+" .pubkey").text(d.pubkey)}});var a=$("#addressbook .footable,#receive .footable").trigger("footable_setup_paging")}function addressLookup(f,d,c){var e=$((d?"#receive":"#addressbook")+" table.footable > tbody").html(),b=$("#address-lookup-table");b.children("tbody").html(e);b.trigger("footable_initialize");b.data("footable-filter").clearFilter();$("#address-lookup-table > tbody tr").selection().on("dblclick",function(){var g=f.split(",");$("#"+g[0]).val($(this).attr("id").trim()).change();if(g[1]!==undefined){$("#"+g[1]).val($(this).attr("lbl").trim()).text($(this).attr("lbl").trim()).change()}$("#address-lookup-modal").modal("hide")});function a(){$("#address-lookup-filter").val($("#address-lookup-address-filter").val()+" "+$("#address-lookup-address-type").val());b.trigger("footable_filter",{filter:$("#address-lookup-filter").val()})}$("#address-lookup-address-filter").on("input",function(){if($("#lookup-address-filter").val()==""){b.data("footable-filter").clearFilter()}a()});$("#address-lookup-address-type").change(function(){if($("#address-lookup-address-type").val()==""){b.data("footable-filter").clearFilter()}a()});if(c){$("#address-lookup-address-type").val(c);a()}}function transactionPageInit(){var a=[{name:"Copy&nbsp;Amount",fun:function(){copy("#transactions .footable .selected .amount","data-value")}},{name:"Copy&nbsp;transaction&nbsp;ID",fun:function(){copy("#transactions .footable .selected","id")}},{name:"Edit&nbsp;label",fun:function(){$("#transactions .footable .selected .editable").dblclick()}},{name:"Show&nbsp;transaction&nbsp;details",fun:function(){$("#transactions .footable .selected").dblclick()}}];$("#transactions .footable tbody").on("contextmenu",function(b){$(b.target).closest("tr").click()}).contextMenu(a,{triggerOn:"contextmenu",sizeStyle:"content"});$("#transactions .footable").on("footable_paging",function(d){var c=filteredTransactions.slice(d.page*d.size);c=c.slice(0,d.size);var b=$("#transactions .footable tbody");b.html("");delete d.ft.pageInfo.pages[d.page];d.ft.pageInfo.pages[d.page]=c.map(function(e){e.html=formatTransaction(e);b.append(e.html);return $("#"+e.id)[0]});d.result=true;bindTransactionTableEvents()}).on("footable_create_pages",function(k){var g=$("#transactions .footable");if(!$(g.data("filter")).val()){filteredTransactions=Transactions}var d=g.data("sorted"),j=g.find("th.footable-sorted").length==1,c="numeric";switch(d){case 0:d="d";break;case 2:d="t_l",c="alpha";break;case 3:d="ad",c="alpha";break;case 4:d="n",c="alpha";break;case 5:d="am";break;default:d="c";break}c=k.ft.options.sorters[c];filteredTransactions.sort(function(i,e){return j?c(i[d],e[d]):c(e[d],i[d])});delete k.ft.pageInfo.pages;k.ft.pageInfo.pages=[];var b=Math.ceil(filteredTransactions.length/k.ft.pageInfo.pageSize),h=[];if(b>0){for(var f=0;f<k.ft.pageInfo.pageSize;f++){h.push([])}for(var f=0;f<b;f++){k.ft.pageInfo.pages.push(h)}}}).on("footable_filtering",function(b){if(b.clear){return true}filteredTransactions=Transactions.filter(function(c){for(var d in c){if(c[d].toString().toLowerCase().indexOf(b.filter.toLowerCase())!==-1){return true}}return false})})}var Transactions=[],filteredTransactions=[];function formatTransaction(a){return"<tr id='"+a.id+"' data-title='"+a.tt+"'>	                <td data-value='"+a.d+"'>"+a.d_s+"</td>                    <td class='trans-status' data-value='"+a.c+"'><center><i class='fa fa-lg "+a.s+"'></center></td>                    <td class='trans_type'><img height='15' width='15' src='assets/icons/tx_"+a.t+".png' /> "+a.t_l+"</td>                    <td class='address' style='color:"+a.a_c+";' data-value='"+a.ad+"' data-label='"+a.ad_l+"'><span class='editable'>"+a.ad_d+"</span></td>                    <td class='trans-nar'>"+a.n+"</td>                    <td class='amount' style='color:"+a.am_c+";' data-value='"+a.am_d+"'>"+a.am_d+"</td>                 </tr>"}function visibleTransactions(a){if(a[0]!=="*"){Transactions=Transactions.filter(function(b){return this.some(function(c){return c==this},b.t_l)},a)}}function bindTransactionTableEvents(){$("#transactions .footable tbody tr").tooltip().on("click",function(){$(this).addClass("selected").siblings("tr").removeClass("selected")}).on("dblclick",function(a){$(this).attr("href","#transaction-info-modal");$("#transaction-info-modal").appendTo("body").modal("show");$("#transaction-info").html(bridge.transactionDetails($(this).attr("id")));$(this).click();$(this).off("click");$(this).on("click",function(){$(this).addClass("selected").siblings("tr").removeClass("selected")})}).find(".editable").on("dblclick",function(a){a.stopPropagation();a.preventDefault();updateValue($(this))}).attr("data-title","Double click to edit").tooltip()}function appendTransactions(a){if(typeof a=="string"){if(a=="[]"){return}a=JSON.parse(a.replace(/,\]$/,"]"))}if(a.length==1&&a[0].id==-1){return}a.sort(function(d,c){d.d=parseInt(d.d);c.d=parseInt(c.d);return c.d-d.d});Transactions=Transactions.filter(function(b){return this.some(function(c){return c.id==this.id},b)==false},a).concat(a);overviewPage.recent(a.slice(0,7));$("#transactions .footable").trigger("footable_redraw")}var contacts={};var contact_list;var contact_group_list;var contact_book_list;var current_key="";function shadowChatInit(){var a=[{name:"Send&nbsp;Shadow",fun:function(){clearRecipients();$("#pay_to0").val($("#contact-list .selected .contact-address").text());$("#navpanel [href=#send]").click()}},{name:"Copy&nbsp;Address",fun:function(){copy("#contact-list .selected .contact-address")}},{name:"Private&nbsp;Message",fun:function(){$("#message-text").focus()}}];$("#contact-list").on("contextmenu",function(b){$(b.target).closest("li").click()}).contextMenu(a,{triggerOn:"contextmenu",sizeStyle:"content"});a=[{name:"Copy&nbsp;Message",fun:function(){var b=$(".contact-discussion li.selected"),c=b.attr("id");$.each(contacts[b.attr("contact-key")].messages,function(d){if(this.id==c){copy(this.message,"copy")}})}},{name:"Delete&nbsp;Message",fun:function(){$(".contact-discussion li.selected").find(".delete").click()}}];$(".contact-discussion").on("contextmenu",function(b){$(b.target).closest("li").addClass("selected")}).contextMenu(a,{triggerOn:"contextmenu",sizeStyle:"content"});a=[{name:"Copy&nbsp;Selected",fun:function(){var b=$("#message-text")[0];if(typeof b.selectionStart!=="undefined"){copy(b.value.substring(b.selectionStart,b.selectionEnd),"copy")}}},{name:"Paste",fun:function(){paste("#pasteTo");var b=$("#message-text")[0];if(typeof b.selectionStart!=="undefined"){b.value=b.value.substring(b.selectionStart,0)+$("#pasteTo").val()+b.value.substring(b.selectionStart)}else{b.value+=$("#pasteTo").val()}}}];$("#message-text").contextMenu(a,{triggerOn:"contextmenu",sizeStyle:"content"});$("#message-text").keypress(function(b){console.log("keypress="+b.which+" shift="+event.shiftKey);if(b.which==13&&!b.shiftKey){b.preventDefault();if($("#message-text").val()==""){return 0}removeNotificationCount();sendMessage()}});$("#messages").selection().on("click",function(b){if(current_key!==""){removeNotificationCount(current_key)}});$("#contact-list").on("mouseover",function(){contactScroll.refresh()});$("#contact-group-list").on("mouseover",function(){contactGroupScroll.refresh()});$("#contact-book-list").on("mouseover",function(){contactBookScroll.refresh()})}function appendMessages(c,b){console.log("appendMessages length="+c.length);contact_list=$("#contact-list ul");contact_group_list=$("#contact-group-list ul");if(b){console.log("reset called");for(var a in contacts){if(contacts[a].messages.length>0){contacts[a].messages=[]}}contact_list.html("");contact_group_list.html("");$("#contact-list").removeClass("in-conversation");$("#contact-group-list").removeClass("in-conversation");$(".contact-discussion ul").html("");$(".user-notifications").hide();$("#message-count").text(0);messagesScroller.scrollTo(0,0);contactScroll.scrollTo(0,0);contactGroupScroll.scrollTo(0,0);contactBookScroll.scrollTo(0,0)}if(c=="[]"){return}console.log(c);c=JSON.parse(c.replace(/,\]$/,"]"));console.log("after json parse");c.forEach(function(d){appendMessage(d.id,d.type,d.sent_date,d.received_date,d.label_value,d.label,d.labelTo,d.to_address,d.from_address,d.read,d.message,b)});if(b){openConversation(contacts[current_key].address,false)}$(contacts[current_key].group?"#contact-group-list":"#contact-list").addClass("in-conversation")}function appendMessage(n,d,s,o,e,h,i,v,f,p,l,c){console.log("appendMessage called");var r=d=="S"?v:f;var m=d=="S"?f:v;var b=r;var t=d=="S"?(i=="(no label)"?m:i):(h=="(no label)"?r:h);var k;var u=r;var g=false;if(i.lastIndexOf("group_",0)===0){k=i.replace("group_","");g=true;u=m}else{if(e.lastIndexOf("group_",0)===0){k=e.replace("group_","");g=true;u=r}else{k=t}}if(l.lastIndexOf("/invite",0)===0&&l.length>=60){var j=l.match(/[V79e][1-9A-HJ-NP-Za-km-z]{50,51}/g);var a=l.substring(61,l.length).replace(/[^A-Za-z0-9\s!?]/g,"");if(j!=null){if(d="R"){if(!p){addInvite(j,a,n)}return false}else{if(d="S"){l="An invite for group "+a+" has been sent."}}}else{if(a.length==0){a=r+"_"+String(j).substring(1,5)}else{if(j==null){l="The group invitation was a malconfigured private key."}}}}createContact(k,u,g);var q=contacts[u];if($.grep(q.messages,function(w){return w.id==n}).length==0){q.messages.push({id:n,them:r,self:m,label_msg:t,group:g,message:l,type:d,sent:s,received:o,read:p});q.messages.sort(function(x,w){return x.received-w.received});appendContact(u,false);if(current_key==u&&!c){openConversation(u,false)}if(d=="R"&&p==0){addNotificationCount(u,1)}}if(current_key==""){current_key=u}}function createContact(c,b,d){var a=contacts[b];if(contacts[b]==undefined){contacts[b]={},a=contacts[b],a.key=b,a.label=c,a.address=b,a.group=d,a.avatar=(false?"":"qrc:///images/default"),a.messages=[]}}function updateContact(e,d,c,b){b=(b!==false);var a=contacts[d];if(a!==undefined){if(c===undefined||d==c){c=""}a.messages.forEach(function(f){if(f.type==="R"&&(f.them===d||f.them===c)){f.label_msg=e}});if(c===""){contacts[d].label=e;$("#contact-book-"+d+" .contact-info .contact-name").text(e);$("#contact-"+d+" .contact-info .contact-name").text(e)}else{$("#contact-book-"+c+" .contact-info .contact-name").text(e);$("#contact-"+c+" .contact-info .contact-name").text(e)}if(openConversation){openConversation(d,true)}}}function appendContact(e,f,g){var i=g?"contact-book-":"contact-";var d=$("#"+i+e);var c=contacts[e];if(d.length===0){var b="";if(c.messages[0]!==undefined&&!g){b=c.messages[0].message}var a="<li id='"+i+e+"' class='contact' data-title='"+c.label+"'>                <span class='contact-info'>                    <span class='contact-name'>"+((c.group&&g)?"<i class='fa fa-users' style='padding-right: 7px;'></i>":"")+c.label+"</span>                    <span class='"+(g?"contact-address":"contact-message")+"'>"+(g?c.address:b)+"</span>                </span>                <span class='contact-options'>                        <span class='message-notifications'>0</span> <span class='delete' onclick='deleteMessages(\""+e+"\")'><i class='fa fa-minus-circle'></i></span>                        </span></li>";if(g){contact_book_list.append(a);$("#"+i+e).find(".delete").hide()}else{if(c.group){contact_group_list.append(a)}else{contact_list.append(a)}}d=$("#"+i+e).selection("li").on("dblclick",function h(j){openConversation(e,true);prependContact(e)}).on("click",function h(j){openConversation(e,true)});if(g){d.on("click",function h(j){})}d.find(".delete").on("click",function(j){j.stopPropagation()});d.find(".message-notifications").hide()}else{if(c.messages!==undefined&&!g){$("#"+i+e+" .contact-info .contact-message").text(c.messages[c.messages.length-1].message)}}if(f){openConversation(e,false)}}function addNotificationCount(c,d){if(contacts[c]==undefined){return false}var a=$("#contact-"+c).find(".message-notifications");var b=a.html();a.text(parseInt(b)+parseInt(d)).show();$(".user-notifications").show();$("#message-count").text(parseInt($("#message-count").text())+1).show();$("#contact-"+c).prependTo(contacts[c].group?"#contact-group-list ul":"#contact-list ul")}function removeNotificationCount(e){if(e==undefined&&current_key!==""){e=current_key}console.log("refresh scoll");messagesScroller.refresh();var a=contacts[e];if(a==undefined){return false}var b=$("#contact-"+e).find(".message-notifications");var c=b.html();if(b.text()==0){return false}b.text(0);b.hide();var g=$("#message-count"),f=parseInt(g.text())-c;g.text(f);if(f==0){g.hide()}else{g.show()}if(a.messages.length==0){return 0}var d=a.messages.length;while(d--){if(!a.messages[d].read){bridge.markMessageAsRead(a.messages[d].id)}}}function openConversation(h,k){if(k){$("#chat-menu-link").click()}current_key=h;var l=$(".contact-discussion ul");var d=contacts[h];l.html("");var e=d.group;$("#chat-header").text(d.label).addClass("editable");$("#chat-header").data("value",d.label);$("#chat-header").off();$("#chat-header").on("dblclick",function(i){i.stopPropagation();updateValueChat($(this),d.key)}).attr("data-title","Double click to edit").tooltip();var m;var g;var f=false;if(k){removeNotificationCount(d.key)}for(var c=0;c<d.messages.length;c++){m=d.messages[c];if(c>0){g=d.messages[c-1];if(combineMessages(g,m)){$("#"+g.id+" .message-text").append(micromarkdown.parse(emojione.toImage(m.message)));continue}}var b=new Date(m.sent*1000);var a=new Date(m.received*1000);var j=(m.label_msg==m.them)?" data-toggle=\"modal\" data-target=\"#add-address-modal\" onclick=\"clearSendAddress(); $('#add-rcv-address').hide(); $('#add-send-address').show(); $('#new-send-address').val('"+m.them+"')\" ":"";l.append("<li id='"+m.id+"' class='"+(m.type=="S"?"my-message":"other-message")+"' contact-key='"+d.key+"'>                    <span class='message-content'>                        <span class='user-name' "+j+">"+(m.label_msg)+"                        </span>                        <span class='timestamp'>"+((b.getHours()<10?"0":"")+b.getHours()+":"+(b.getMinutes()<10?"0":"")+b.getMinutes()+":"+(b.getSeconds()<10?"0":"")+b.getSeconds())+"</span>                           <span class='delete' onclick='deleteMessages(\""+d.key+'", "'+m.id+"\");'><i class='fa fa-minus-circle'></i></span>                            <span class='info'>                           <span class='message-text'>"+micromarkdown.parse(emojione.toImage(m.message)).replace(/<a href="(.+)">.+<\/a>/g,'<a href="$1" data-title="$1">$1</a>')+"</span>                    </span></li>");$("#"+m.id+" .timestamp").attr("data-title","Sent: "+b.toLocaleString()+"\n Received: "+a.toLocaleString()).tooltip().find(".message-text").tooltip();if(m.type=="S"){$("#"+m.id+" .user-name").attr("data-title",""+m.self).tooltip();addRandomAvatar(m.id,m.self);if(m.group&&!f){f=true;$("#message-from-address").val(m.self);$("#message-to-address").val(m.them)}}else{$("#"+m.id+" .user-name").attr("data-title",""+m.them).tooltip();addRandomAvatar(m.id,m.them)}}if(!f&&d.messages.length>0){if(!e){$("#message-from-address").val(m.self);$("#message-to-address").val(m.them)}else{if(m.type=="R"){$("#message-to-address").val(m.self)}}}else{if(d.messages.length==0){$(".contact-discussion ul").html("<li id='remove-on-send'>Starting Conversation with "+d.label+" - "+d.address+"</li>");$("#message-to-address").val(d.address)}}console.log("REFRESHING");setTimeout(function(){scrollMessages()},200)}function combineMessages(b,a){return false;if(b.type!=a.type){return false}if(a.type=="R"&&b.them==a.them){return true}if(a.type=="S"&&b.self==a.self){return true}console.log("Messages are not going to combine!");return false}function addRandomAvatar(b,a){$("#"+b+" .info").append($("<canvas/>").attr({width:40,height:40}).jdenticon(md5(a)))}function prependContact(b){var a=contacts[b];if(!a.group){$("#contact-list").addClass("in-conversation");$("#contact-"+b).prependTo($("#contact-list ul"))}else{$("#contact-group-list").addClass("in-conversation");$("#contact-"+b).prependTo($("#contact-group-list ul"))}}function addInvite(a,b,c){if($("#invite-"+a+"-"+c).length!=0){return false}$("#group-invite-list").append("<div id='invite-"+a+"-"+c+'\'><a class=\'group-invite\'><i class="fa fa-envelope"></i><span class="group-invite-label"> '+b+' </span><i class="fa fa-check group-invite-check" onclick="acceptInvite(\''+a+"','"+b+"', '"+c+'\');"></i><i class="fa fa-close group-invite-close" onclick="deleteInvite(\''+a+"','"+c+"');\"></i></a></div>")}function deleteInvite(a,b){bridge.deleteMessage(b);$("#invite-"+a+"-"+b).html("")}function acceptInvite(b,a,d){deleteInvite(b,d);var c=bridge.joinGroupChat(b,a);if(c==="false"){return false}updateContact(a,c);createContact(a,c,true);appendContact(c,true,false)}function openInviteModal(){var c=[];var a=$("#new-group-name").val();if(a==""){return false}$("#filter-new-group").text("");$("#invite-modal-tbody tr").each(function(){var e=$(this).find(".address").text();var f=$(this).find(".invite .checkbox").is(":checked");if(f){c.push(e)}});$("#new-group-modal").modal("hide");var d=bridge.createGroupChat(a);var b=[];if(c.length>0){b=bridge.inviteGroupChat(d,c,$("#message-from-address").val())}createContact(a,d,true);appendContact(d,true,false)}function scrollMessages(){messagesScroller.refresh();var a=function(){var b=messagesScroller.y;messagesScroller.refresh();if(b!==messagesScroller.maxScrollY){messagesScroller.scrollTo(0,messagesScroller.maxScrollY,100)}};setTimeout(a,100)}function newConversation(){var a=$("#new-contact-address").val();var b=$("#new-contact-name").val();createContact(b,a,false);result=bridge.newAddress($("#new-contact-name").val(),0,$("#new-contact-address").val(),true);if(result===""){if(bridge.lastAddressError()!=="Duplicate Address."){$("#new-contact-address").css("background","#E51C39").css("color","white");return}}$("#new-contact-address").css("background","").css("color","");bridge.setPubKey($("#new-contact-address").val(),$("#new-contact-pubkey").val());bridge.updateAddressLabel($("#new-contact-address").val(),$("#new-contact-name").val());$("#new-contact-modal").modal("hide");$("#message-to-address").val($("#new-contact-address").val());$("#message-text").focus();$("#new-contact-address").val("");$("#new-contact-name").val("");$("#new-contact-pubkey").val("");$("#contact-list ul li").removeClass("selected");$("#contact-list").addClass("in-conversation");$("#contact-group-list ul li").removeClass("selected");$("#contact-group-list").addClass("in-conversation");setTimeout(function(){openConversation(a,true);$(".contact-discussion ul").html("<li id='remove-on-send'>Starting Conversation with "+a+" - "+b+"</li>")},1000);console.log("reached end")}function sendMessage(){$("#remove-on-send").remove();if(bridge.sendMessage(current_key,$("#message-text").val(),$("#message-from-address").val())){$("#message-text").val("")}}function deleteMessages(e,b){var a=contacts[e];if(!confirm("Are you sure you want to delete "+(b==undefined?"these messages?":"this message?"))){return false}var c=$("#message-count"),f=parseInt(c.text());removeNotificationCount(e);if(b==undefined){current_key=""}for(var d=0;d<a.messages.length;d++){if(b===undefined){if(bridge.deleteMessage(a.messages[d].id)){$("#"+a.messages[d].id).remove();a.messages.splice(d,1);d--}else{return false}}else{if(a.messages[d].id===b){if(bridge.deleteMessage(b)){$("#"+b).remove();a.messages.splice(d,1);d--;break}else{return false}}}}if(a.messages.length==0){$("#contact-"+e).remove();$("#contact-list").removeClass("in-conversation");$("#contact-group-list").removeClass("in-conversation")}else{iscrollReload();openConversation(e,false)}}function signMessage(){$("#sign-signature").val("");var c,e,d,b="";c=$("#sign-address").val().trim();e=$("#sign-message").val().trim();var a=bridge.signMessage(c,e);d=a.error_msg;b=a.signed_signature;if(d!==""){$("#sign-result").removeClass("green");$("#sign-result").addClass("red");$("#sign-result").html(d);return false}else{$("#sign-signature").val(a.signed_signature);$("#sign-result").removeClass("red");$("#sign-result").addClass("green");$("#sign-result").html("Message signed successfully")}}function verifyMessage(){var c,e,d,b="";c=$("#verify-address").val().trim();e=$("#verify-message").val().trim();b=$("#verify-signature").val().trim();var a=bridge.verifyMessage(c,e,b);d=a.error_msg;if(d!==""){$("#verify-result").removeClass("green");$("#verify-result").addClass("red");$("#verify-result").html(d);return false}else{$("#verify-result").removeClass("red");$("#verify-result").addClass("green");$("#verify-result").html("Message verified successfully")}}var contactScroll=new IScroll("#contact-list",{mouseWheel:true,lockDirection:true,scrollbars:true,interactiveScrollbars:true,scrollbars:"custom",scrollY:true,scrollX:false,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|P|SPAN)$/}});var contactGroupScroll=new IScroll("#contact-group-list",{mouseWheel:true,lockDirection:true,scrollbars:true,interactiveScrollbars:true,scrollbars:"custom",scrollY:true,scrollX:false,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|P|SPAN)$/}});var contactBookScroll=new IScroll("#contact-book-list",{mouseWheel:true,lockDirection:true,scrollbars:true,interactiveScrollbars:true,scrollbars:"custom",scrollY:true,scrollX:false,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|P|SPAN)$/}});var messagesScroller=new IScroll(".contact-discussion",{mouseWheel:true,lockDirection:true,scrollbars:true,interactiveScrollbars:true,scrollbars:"custom",scrollY:true,scrollX:false,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|P|SPAN)$/}});function iscrollReload(a){contactScroll.refresh();contactGroupScroll.refresh();contactBookScroll.refresh();messagesScroller.refresh();if(a===true){messagesScroller.scrollTo(0,messagesScroller.maxScrollY,0)}}function editorCommand(g,d){var c,h,b,a,f;var e=$("#message-text")[0];f=e.scrollTop;e.focus();if(typeof e.selectionStart!=="undefined"){h=e.selectionStart;b=e.selectionEnd;a=g.length;if(d){g+=e.value.substring(h,b)+d}e.value=e.value.substring(0,h)+g+e.value.substring(b,e.value.length);e.selectionStart=(h+g.length)-(d?d.length:0);e.selectionEnd=e.selectionStart}else{e.value+=g+d}e.scrollTop=f;e.focus()}var chainDataPage={anonOutputs:{},init:function(){$("#show-own-outputs,#show-all-outputs").on("click",function(a){$(a.target).hide().siblings("a").show()});$("#show-own-outputs").on("click",function(){$("#chaindata .footable tbody tr>td:first-child+td").each(function(){if($(this).text()==0){$(this).parents("tr").hide()}})});$("#show-all-outputs").on("click",function(){$("#chaindata .footable tbody tr:hidden").show()})},updateAnonOutputs:function(){chainDataPage.anonOutputs=bridge.listAnonOutputs();var a=$("#chaindata .footable tbody");a.html("");for(value in chainDataPage.anonOutputs){var b=chainDataPage.anonOutputs[value];a.append("<tr>                    <td data-value="+value+">"+b.value_s+"</td>                    <td>"+b.owned_outputs+(b.owned_outputs==b.owned_mature?"":" (<b>"+b.owned_mature+"</b>)")+"</td>                    <td>"+b.system_outputs+" ("+b.system_mature+")</td>                    <td>"+b.system_spends+"</td>                    <td>"+b.least_depth+"</td>                </tr>")}$("#chaindata .footable").trigger("footable_initialize")}};var blockExplorerPage={blockHeader:{},findBlock:function(c){if(c===""||c===null){blockExplorerPage.updateLatestBlocks()}else{blockExplorerPage.foundBlock=bridge.findBlock(c);if(blockExplorerPage.foundBlock.error_msg!==""){$("#latest-blocks-table  > tbody").html("");$("#block-txs-table > tbody").html("");$("#block-txs-table").addClass("none");alert(blockExplorerPage.foundBlock.error_msg);return false}var b=$("#latest-blocks-table  > tbody");b.html("");var a=$("#block-txs-table  > tbody");a.html("");$("#block-txs-table").addClass("none");b.append("<tr data-value="+blockExplorerPage.foundBlock.block_hash+">                                     <td>"+blockExplorerPage.foundBlock.block_hash+"</td>                                     <td>"+blockExplorerPage.foundBlock.block_height+"</td>                                     <td>"+blockExplorerPage.foundBlock.block_timestamp+"</td>                                     <td>"+blockExplorerPage.foundBlock.block_transactions+"</td>                        </tr>");blockExplorerPage.prepareBlockTable()}},updateLatestBlocks:function(){blockExplorerPage.latestBlocks=bridge.listLatestBlocks();var a=$("#block-txs-table  > tbody");a.html("");$("#block-txs-table").addClass("none");var b=$("#latest-blocks-table  > tbody");b.html("");for(value in blockExplorerPage.latestBlocks){var c=blockExplorerPage.latestBlocks[value];b.append("<tr data-value="+c.block_hash+">                         <td>"+c.block_hash+"</td>                         <td>"+c.block_height+"</td>                         <td>"+c.block_timestamp+"</td>                         <td>"+c.block_transactions+"</td>                         </tr>")}blockExplorerPage.prepareBlockTable()},prepareBlockTable:function(){$("#latest-blocks-table  > tbody tr").selection().on("click",function(){var b=$(this).attr("data-value").trim();blockExplorerPage.blkTxns=bridge.listTransactionsForBlock(b);var a=$("#block-txs-table  > tbody");a.html("");for(value in blockExplorerPage.blkTxns){var c=blockExplorerPage.blkTxns[value];a.append("<tr data-value="+c.transaction_hash+">                                    <td>"+c.transaction_hash+"</td>                                    <td>"+c.transaction_value+"</td>                                    </tr>")}$("#block-txs-table").removeClass("none");$("#block-txs-table > tbody tr").selection().on("dblclick",function(f){$("#blkexp-txn-modal").appendTo("body").modal("show");selectedTxn=bridge.txnDetails(b,$(this).attr("data-value").trim());if(selectedTxn.error_msg==""){$("#txn-hash").html(selectedTxn.transaction_hash);$("#txn-size").html(selectedTxn.transaction_size);$("#txn-rcvtime").html(selectedTxn.transaction_rcv_time);$("#txn-minetime").html(selectedTxn.transaction_mined_time);$("#txn-blkhash").html(selectedTxn.transaction_block_hash);$("#txn-reward").html(selectedTxn.transaction_reward);$("#txn-confirmations").html(selectedTxn.transaction_confirmations);$("#txn-value").html(selectedTxn.transaction_value);$("#error-msg").html(selectedTxn.error_msg);if(selectedTxn.transaction_reward>0){$("#lbl-reward-or-fee").html("<strong>Reward</strong>");$("#txn-reward").html(selectedTxn.transaction_reward)}else{$("#lbl-reward-or-fee").html("<strong>Fee</strong>");$("#txn-reward").html(selectedTxn.transaction_reward*-1)}}var i=$("#txn-detail-inputs > tbody");i.html("");for(value in selectedTxn.transaction_inputs){var g=selectedTxn.transaction_inputs[value];i.append("<tr data-value="+g.input_source_address+">                                                   <td>"+g.input_source_address+"</td>                                                   <td>"+g.input_value+"</td>                                                </tr>")}var h=$("#txn-detail-outputs > tbody");h.html("");for(value in selectedTxn.transaction_outputs){var d=selectedTxn.transaction_outputs[value];h.append("<tr data-value="+d.output_source_address+">                                                 <td>"+d.output_source_address+"</td>                                                 <td>"+d.output_value+"</td>                                            </tr>")}$(this).click().off("click").selection()}).find(".editable")}).on("dblclick",function(a){$("#block-info-modal").appendTo("body").modal("show");selectedBlock=bridge.blockDetails($(this).attr("data-value").trim());if(selectedBlock){$("#blk-hash").html(selectedBlock.block_hash);$("#blk-numtx").html(selectedBlock.block_transactions);$("#blk-height").html(selectedBlock.block_height);$("#blk-type").html(selectedBlock.block_type);$("#blk-reward").html(selectedBlock.block_reward);$("#blk-timestamp").html(selectedBlock.block_timestamp);$("#blk-merkleroot").html(selectedBlock.block_merkle_root);$("#blk-prevblock").html(selectedBlock.block_prev_block);$("#blk-nextblock").html(selectedBlock.block_next_block);$("#blk-difficulty").html(selectedBlock.block_difficulty);$("#blk-bits").html(selectedBlock.block_bits);$("#blk-size").html(selectedBlock.block_size);$("#blk-version").html(selectedBlock.block_version);$("#blk-nonce").html(selectedBlock.block_nonce)}$(this).click().off("click").selection()}).find(".editable")}};var walletManagementPage={init:function(){setupWizard("new-key-wizard");setupWizard("recover-key-wizard");setupWizard("open-key-wizard")},newMnemonic:function(){var a=bridge.getNewMnemonic($("#new-account-passphrase").val(),$("#new-account-language").val());var b=a.error_msg;var c=a.mnemonic;if(b!==""){alert(b)}else{$("#new-key-mnemonic").val(c)}},compareMnemonics:function(){var a=$("#new-key-mnemonic").val().trim();var b=$("#validate-key-mnemonic").val().trim();if(a==b){$("#validate-key-mnemonic").removeClass("red");$("#validate-key-mnemonic").val("");return true}else{$("#validate-key-mnemonic").addClass("red");alert("The recovery phrase you provided does not match the recovery phrase that was generated earlier - please go back and check to make sure you have copied it down correctly.");return false}},gotoPage:function(a){$("#navitems a[href='#"+a+"']").trigger("click")},prepareAccountTable:function(){$("#extkey-account-table  > tbody tr").selection().on("click",function(){var a=$("#extkey-table > tbody > tr");a.removeClass("selected")})},updateAccountList:function(){walletManagementPage.accountList=bridge.extKeyAccList();var a=$("#extkey-account-table  > tbody");a.html("");for(value in walletManagementPage.accountList){var b=walletManagementPage.accountList[value];a.append("<tr data-value="+b.id+" active-flag="+b.active+">                         <td>"+b.id+"</td>                         <td>"+b.label+"</td>                         <td>"+b.created_at+'</td>                         <td class="center-margin"><i style="font-size: 1.2em; margin: auto;" '+((b.active=="true")?'class="fa fa-circle green-circle"':'class="fa fa-circle red-circle"')+' ></i></td>                         <td style="font-size: 1em; margin-bottom: 6px;">'+((b.default_account!==undefined?"<i class='center fa fa-check'></i>":""))+"</td>                         </tr>")}walletManagementPage.prepareAccountTable()},prepareKeyTable:function(){$("#extkey-table  > tbody tr").selection().on("click",function(){var a=$("#extkey-account-table > tbody > tr");a.removeClass("selected")})},updateKeyList:function(){walletManagementPage.keyList=bridge.extKeyList();var a=$("#extkey-table  > tbody");a.html("");for(value in walletManagementPage.keyList){var b=walletManagementPage.keyList[value];a.append("<tr data-value="+b.id+" active-flag="+b.active+">                         <td>"+b.id+"</td>                         <td>"+b.label+"</td>                         <td>"+b.path+'</td>                         <td><i style="font-size: 1.2em; margin: auto;" '+((b.active=="true")?'class="fa fa-circle green-circle"':'class="fa fa-circle red-circle"')+' ></i></td>                         <td style="font-size: 1em; margin-bottom: 6px;">'+((b.current_master!==undefined?"<i class='center fa fa-check'></i>":""))+"</td>                         </tr>")}walletManagementPage.prepareKeyTable()},newKey:function(){result=bridge.importFromMnemonic($("#new-key-mnemonic").val().trim(),$("#new-account-passphrase").val().trim(),$("#new-account-label").val().trim(),$("#new-account-bip44").prop("checked"));if(result.error_msg!==""){alert(result.error_msg);return false}},recoverKey:function(){result=bridge.importFromMnemonic($("#recover-key-mnemonic").val().trim(),$("#recover-passphrase").val().trim(),$("#recover-account-label").val().trim(),$("#recover-bip44").prop("checked"),1443657600);if(result.error_msg!==""){alert(result.error_msg);return false}else{return true}},setMaster:function(){var a=$("#extkey-table tr.selected");if(!a.length){alert("Please select a key to set it as master.");return false}selected=$("#extkey-table tr.selected").attr("data-value").trim();if(selected!==undefined&&selected!==""){result=bridge.extKeySetMaster(selected);if(result.error_msg!==""){alert(result.error_msg);return false}else{walletManagementPage.updateKeyList()}}else{alert("Select a key from the table to set a Master.");return false}},setDefault:function(){var a=$("#extkey-account-table tr.selected");if(!a.length){alert("Please select an account to set it as default.");return false}selected=$("#extkey-account-table tr.selected").attr("data-value").trim();if(selected!==undefined&&selected!==""){result=bridge.extKeySetDefault(selected);if(result.error_msg!==""){alert(result.error_msg);return false}else{walletManagementPage.updateAccountList()}}else{alert("Select an account from the table to set a default.");return false}},changeActiveFlag:function(){var b=false;var c=$("#extkey-account-table tr.selected");var a=$("#extkey-table tr.selected");if(!c.length&&!a.length){alert("Please select an account or key to change the active status.");return false}if(c.length){selected=c.attr("data-value").trim();active=c.attr("active-flag").trim();b=true}else{selected=a.attr("data-value").trim();active=a.attr("active-flag").trim()}if(selected!==undefined&&selected!==""){result=bridge.extKeySetActive(selected,active);if(result.error_msg!==""){alert(result.error_msg);return false}else{if(b){walletManagementPage.updateAccountList()}else{walletManagementPage.updateKeyList()}}}else{alert("Please select an account or key to change the active status.");return false}}};function setupWizard(b){var a=$("#"+b+" > div");backbtnjs='$("#key-options").show(); $("#wizards").hide();';fwdbtnjs='gotoWizard("new-key-wizard", 1);';$("#"+b).prepend("<div id='backWiz' style='display:none;' class='btn btn-default btn-cons wizardback' onclick='"+backbtnjs+"' >Back</div>");$("#"+b).prepend("<div id='fwdWiz'  style='display:none;' class='btn btn-default btn-cons wizardfwd'  onclick='"+fwdbtnjs+"' >Next Step</div>");a.each(function(c){$(this).addClass("step"+c);$(this).hide();$("#backWiz").hide()})}function gotoWizard(section,step,runStepJS){var sections=$("#wizards > div");validateJS=$("#"+section+" .step"+(step-1)).attr("validateJS");if(runStepJS&&validateJS!==undefined){var valid=eval(validateJS);if(!valid){return false}}sections.each(function(i){$(this).hide()});var steps=$("#"+section+" > div[class^=step]");var gotoStep=step;if(gotoStep==null){gotoStep=0}if(gotoStep==0){$("#"+section+" #backWiz").attr("onclick",'$(".wizardback").hide(); $("#wizards").show();');$("#"+section+" #fwdWiz").attr("onclick",'$(".wizardback").hide(); gotoWizard("'+section+'", 1, true);');$("#backWiz").hide()}else{$("#"+section+" #backWiz").attr("onclick",'gotoWizard("'+section+'", '+(gotoStep-1)+" , false);");$("#"+section+" #fwdWiz").attr("onclick",'gotoWizard("'+section+'", '+(gotoStep+1)+" , true);")}endWiz=$("#"+section+" .step"+(step)).attr("endWiz");if(endWiz!==undefined&&endWiz!==""){$("#"+section+" #fwdWiz").attr("onclick",endWiz)}steps.each(function(i){$(this).hide()});$("#"+section).show();stepJS=$("#"+section+" .step"+gotoStep).attr("stepJS");if(runStepJS&&stepJS!==undefined){eval(stepJS)}$("#"+section+" .step"+gotoStep).fadeIn(0)};